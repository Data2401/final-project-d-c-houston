---
title: "Texan Data"
author: "Andy Berrios"
date: '2022-04-26'
output:   
  html_document:
    highlight: pygments
    theme: readable
editor_options: 
  chunk_output_type: console
---

```{r, include=FALSE}
library(tidyverse)
library(gganimate)
library(ggplot2)
library(ggthemes)
library(showtext)
library(ggridges)
```


```{r, include=FALSE}
# Loading CSV Data Sets
## Jobs
HTX_Work <- read.csv("Houston Industries.csv")
DTX_Work <- read.csv("Dallas Industries.csv")
SATX_Work <- read.csv("SanAnton Industries.csv")
HTX_Income <- read.csv("Houston Income.csv")
DTX_Income <- read.csv("Dallas Income.csv")
SATX_Income <- read.csv("SanAnton Income.csv")

## Cost of Living
HTX_House <- read.csv("Houston Property.csv")
DTX_House <- read.csv("Dallas Property.csv")
SATX_House <- read.csv("SanAnton Property.csv")
Commute <- read_csv("Commute.csv")

## Demographics
HTX_People <- read.csv("Houston Diversity.csv")
DTX_People <- read.csv("Dallas Diversity.csv")
SATX_People <- read.csv("SanAnton Diversity.csv")
```

Where is your future? Where will your next chapter begin?

According to XXXXX, there are three major components to look out for when planning a move; Potential Job Perspectives, Cost of Living, and Demographics.


Firstly let us consider what you need to survive: Money!

```{r, include=FALSE}
# Display Industries
H <- HTX_Work %>% 
  group_by(Year) %>% 
  slice_max( order_by = Workforce.by.Industry.and.Gender, n = 5) %>% 
  summarise(Industry_Population = mean(Workforce.by.Industry.and.Gender)) %>% 
  mutate(City = "Houston")
D <- DTX_Work %>% 
  group_by(Year) %>% 
  slice_max( order_by = Workforce.by.Industry.and.Gender, n = 5) %>% 
  summarise(Industry_Population = mean(Workforce.by.Industry.and.Gender)) %>% 
  mutate(City = "Dallas")
SA <- SATX_Work %>% 
  group_by(Year) %>% 
  slice_max( order_by = Workforce.by.Industry.and.Gender, n = 5) %>% 
  summarise(Industry_Population = mean(Workforce.by.Industry.and.Gender)) %>% 
  mutate(City = "San Antonio")
```

```{r, echo=FALSE}
## Overall Industry comparison
g <- rbind(H, D, SA)
options(scipen = 999)
ggplot(g) + 
  geom_line(aes( x = Year, y = Industry_Population, color = City), size = 1.5) +  
  labs( title = "Industry Growth", subtitle = "Top 5 Industries in Houston, Dallas, and San Antonio", x = "Year", y = "Workforce Number", color = "City") +
  theme_fivethirtyeight() +
  theme(axis.title = element_text()) +
  scale_x_continuous(breaks = 2013:2019) 

## Individual Cities
HTX_Work %>% 
  group_by(Year) %>% 
  select(Industry, Workforce.by.Industry.and.Gender, Year, Geography) %>% 
  slice_max( order_by = Workforce.by.Industry.and.Gender, n = 5) %>% 
  ggplot(aes(x = Year, y = Workforce.by.Industry.and.Gender, color = Industry)) +
  geom_line( size= 1.5 , alpha = .8) +
  labs( title = "Industry Growth in Houston", subtitle = "Top 5 Largest Industries", x = "Year", y = "Workforce Number") +
  theme_fivethirtyeight() +
  theme(axis.title = element_text()) +
  scale_x_continuous(breaks = 2013:2019) +
  guides(color = guide_legend(nrow = 4))

DTX_Work %>% 
  group_by(Year) %>% 
  select(Industry, Workforce.by.Industry.and.Gender, Year, Geography) %>% 
  slice_max( order_by = Workforce.by.Industry.and.Gender, n = 5) %>% 
  ggplot(aes(x = Year, y = Workforce.by.Industry.and.Gender, color = Industry)) +
  geom_line( size= 1.5 , alpha = .8) +
  labs( title = "Industry Growth in Dallas", subtitle = "Top 5 Largest Industries", x = "Year", y = "Workforce Number") +
  theme_fivethirtyeight() +
  theme(axis.title = element_text()) +
  scale_x_continuous(breaks = 2013:2019) +
  guides(color = guide_legend(nrow = 4))

options(scipen = 999)
SATX_Work %>% 
  group_by(Year) %>% 
  select(Industry, Workforce.by.Industry.and.Gender, Year, Geography) %>% 
  slice_max( order_by = Workforce.by.Industry.and.Gender, n = 5) %>% 
  ggplot(aes(x = Year, y = Workforce.by.Industry.and.Gender, color = Industry)) +
  geom_line( size= 1.5 , alpha = .8) +
  labs( title = "Industry Growth in San Antonio", subtitle = "Top 5 Largest Industries", x = "Year", y = "Workforce Number") +
  theme_fivethirtyeight() +
  theme(axis.title = element_text()) +
  scale_x_continuous(breaks = 2013:2019) +
  guides(color = guide_legend(nrow = 4))
```


Now, let's see how much you could potentially be making!
```{r, echo=FALSE}
## Display Income
options(scipen = 999)
rbind(HTX_Income, DTX_Income, SATX_Income) %>% 
  filter(Geography == "Houston, TX" | Geography == "Dallas, TX" |Geography == "San Antonio, TX") %>% select(Year, Geography, Household.Income.by.Race) %>% 
  ggplot(aes( x = Year, y = Household.Income.by.Race, color = Geography)) +
  geom_line( size = 1.5, alpha = .65) + 
  labs( title = "Median Household Income", subtitle = "Within Houston, Dallas and San Antonio", x = "Year", y = "Median Income") + 
  theme_fivethirtyeight() +
  theme(axis.title = element_text()) +
  scale_x_continuous(breaks = 2013:2019)
  
```

Moving on to the 'Cost of Living'.
Lets dive deeper into the cost of a housing in the area as well as what an individual can expect when it comes to commute time.

```{r, echo=FALSE}
Housing <- rbind(HTX_House, DTX_House,SATX_House)

Texas_Housing <- Housing %>% filter(Year == "2019") %>% 
  filter(Geography == "Houston, TX" | Geography == "Dallas, TX" |Geography == "San Antonio, TX")


  ggplot(data = Texas_Housing,aes( x = reorder(Value.Bucket, -ID.Value.Bucket), y = Property.Value.by.Bucket, fill = Geography)) +
  geom_bar( stat = "identity" ,position = "dodge") + coord_flip() + labs( title = "Housing Market in Major Texan Cities", subtitle = "2019", x = "Value of Homes", y = "Number of Homes Sold") + theme(axis.title = element_text())
```

So what can we see?
In Houston most homes sold are between $200,000 to $400,000
In Dallas most homes sold are between $300,000 to $750,000
In San Antonio most homes sold are between $200,000 to $250,000

Alot more options for 'affordable housing' in the San Antonio and Houston area! Directly correalting to the massive construction industry.

```{r, echo=FALSE}
## Commute
Texas_Commmute <- Commute %>% filter(Place == "Houston, TX" | Place == "Dallas, TX" |Place == "San Antonio, TX") 
  
  
  ggplot( Texas_Commmute , aes(x = `Average Commute Time`, y = Place)) + geom_density_ridges(aes(fill = Place), alpha = .7) + 
    labs( title = " Commute Time", subtitle = "Within Houston, Dallas and San Antonio", x = "Average Commute Time", y = "Location") + 
  theme_fivethirtyeight() +
  theme(axis.title = element_text())


```


# References
```
https://www.moving.com/tips/how-to-choose-the-right-city-for-you/ 
```













