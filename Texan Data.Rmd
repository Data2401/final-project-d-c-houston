---
title: "Texan Data"
author: "Andy Berrios"
date: '2022-04-26'
output:   
  slidy_presentation:
    highlight: pygments
    theme: readable
editor_options: 
  chunk_output_type: console
---

```{r, include=FALSE}
library(tidyverse)
library(gganimate)
library(ggplot2)
library(ggthemes)
library(showtext)
library(ggridges)
library(treemap)
```


```{r, include=FALSE}
# Loading CSV Data Sets
## Jobs
HTX_Work <- read.csv("Houston Industries.csv")
DTX_Work <- read.csv("Dallas Industries.csv")
SATX_Work <- read.csv("SanAnton Industries.csv")
HTX_Income <- read.csv("Houston Income.csv")
DTX_Income <- read.csv("Dallas Income.csv")
SATX_Income <- read.csv("SanAnton Income.csv")

## Cost of Living
HTX_House <- read.csv("Houston Property.csv")
DTX_House <- read.csv("Dallas Property.csv")
SATX_House <- read.csv("SanAnton Property.csv")
Commute <- read_csv("Commute.csv")

## Demographics
HTX_People <- read.csv("Houston Diversity.csv")
DTX_People <- read.csv("Dallas Diversity.csv")
SATX_People <- read.csv("SanAnton Diversity.csv")
```


# Where is your future? Where will your next opportunity begin?

# Wether for future investments or a change in scenery let's take a closer look at Houston, Dallas, and San Antonio!

According to Moving.com, there are three major components to look out for when planning a move or purchase: Potential Job Perspectives, Cost of Living, and Demographics.


# First, let's consider what you need to survive in America: Money! 
Each city will have different industries that thrive between it's borders. Lets compare the different size and growth of all industries as a whole within their respective city!

```{r, include=FALSE}
# Display Industries
H <- HTX_Work %>% 
  group_by(Year) %>% 
  slice_max( order_by = Workforce.by.Industry.and.Gender, n = 5) %>% 
  summarise(Industry_Population = mean(Workforce.by.Industry.and.Gender)) %>% 
  mutate(City = "Houston")
D <- DTX_Work %>% 
  group_by(Year) %>% 
  slice_max( order_by = Workforce.by.Industry.and.Gender, n = 5) %>% 
  summarise(Industry_Population = mean(Workforce.by.Industry.and.Gender)) %>% 
  mutate(City = "Dallas")
SA <- SATX_Work %>% 
  group_by(Year) %>% 
  slice_max( order_by = Workforce.by.Industry.and.Gender, n = 5) %>% 
  summarise(Industry_Population = mean(Workforce.by.Industry.and.Gender)) %>% 
  mutate(City = "San Antonio")
```


```{r, echo=FALSE}
## Overall Industry comparison
g <- rbind(H, D, SA)
options(scipen = 999)
ggplot(g) + 
  geom_line(aes( x = Year, y = Industry_Population, color = City), size = 1.5) +  
  labs( title = "Industry Growth", subtitle = "Top 5 Industries in Houston, Dallas, and San Antonio", x = "Year", y = "Workforce Number", color = "City") +
  theme_fivethirtyeight() +
  theme(axis.title = element_text(),
        legend.text = element_text(size = 10)) +
  scale_x_continuous(breaks = 2013:2019) 
```

We can tell here the difference of industry size within each city. However, looks can be deceiving, so lets take a closer look at the industries within each city!
```{r, echo=FALSE}
## Individual Cities
HTX_Work %>% 
  group_by(Year) %>% 
  select(Industry, Workforce.by.Industry.and.Gender, Year, Geography) %>% 
  slice_max( order_by = Workforce.by.Industry.and.Gender, n = 5) %>% 
  ggplot(aes(x = Year, y = Workforce.by.Industry.and.Gender, color = Industry)) +
  geom_line( size= 1.5 , alpha = .8) +
  labs( title = "Industry Growth in Houston", subtitle = "Top 5 Largest Industries", x = "Year", y = "Workforce Number") +
  theme_fivethirtyeight() +
  theme(axis.title = element_text(),
        legend.text = element_text(size = 10)) +
  scale_x_continuous(breaks = 2013:2019) +
  guides(color = guide_legend(nrow = 4))

DTX_Work %>% 
  group_by(Year) %>% 
  select(Industry, Workforce.by.Industry.and.Gender, Year, Geography) %>% 
  slice_max( order_by = Workforce.by.Industry.and.Gender, n = 5) %>% 
  ggplot(aes(x = Year, y = Workforce.by.Industry.and.Gender, color = Industry)) +
  geom_line( size= 1.5 , alpha = .8) +
  labs( title = "Industry Growth in Dallas", subtitle = "Top 5 Largest Industries", x = "Year", y = "Workforce Number") +
  theme_fivethirtyeight() +
  theme(axis.title = element_text(),
        legend.text = element_text(size = 10)) +
  scale_x_continuous(breaks = 2013:2019) +
  guides(color = guide_legend(nrow = 4))

options(scipen = 999)
SATX_Work %>% 
  group_by(Year) %>% 
  select(Industry, Workforce.by.Industry.and.Gender, Year, Geography) %>% 
  slice_max( order_by = Workforce.by.Industry.and.Gender, n = 5) %>% 
  ggplot(aes(x = Year, y = Workforce.by.Industry.and.Gender, color = Industry)) +
  geom_line( size= 1.5 , alpha = .8) +
  labs( title = "Industry Growth in San Antonio", subtitle = "Top 5 Largest Industries", x = "Year", y = "Workforce Number") +
  theme_fivethirtyeight() +
  theme(axis.title = element_text(),
        legend.text = element_text(size = 10)) +
  scale_x_continuous(breaks = 2013:2019) +
  guides(color = guide_legend(nrow = 4))
```


Now, let's see how much you could potentially be making!
```{r, echo=FALSE}
## Display Income
options(scipen = 999)
rbind(HTX_Income, DTX_Income, SATX_Income) %>% 
  filter(Geography == "Houston, TX" | Geography == "Dallas, TX" |Geography == "San Antonio, TX") %>% select(Year, Geography, Household.Income.by.Race) %>% 
  ggplot(aes( x = Year, y = Household.Income.by.Race, color = Geography)) +
  geom_line( size = 1.5, alpha = .65) + 
  labs( title = "Median Household Income", subtitle = "Within Houston, Dallas and San Antonio", x = "Year", y = "Median Income") + 
  theme_fivethirtyeight() +
  theme(axis.title = element_text(),
        legend.text = element_text(size = 10)) +
  scale_x_continuous(breaks = 2013:2019)
  
```

# Moving on to the 'Cost of Living'.
Lets dive deeper into the housing market in each city as well as what an individual can expect when it comes to commute time.

# Housing sales grouped by thier price of sale

```{r, echo=FALSE}
Housing <- rbind(HTX_House, DTX_House,SATX_House)

Texas_Housing <- Housing %>% filter(Year == "2019") %>% 
  filter(Geography == "Houston, TX" | Geography == "Dallas, TX" |Geography == "San Antonio, TX")


  ggplot(data = Texas_Housing,aes( x = reorder(Value.Bucket, -ID.Value.Bucket), y = Property.Value.by.Bucket, fill = Geography)) +
  geom_bar( stat = "identity" ,position = "dodge") + coord_flip() + labs( title = "Housing Market in Major Texan Cities", subtitle = "2019", x = "Value of Homes", y = "Number of Homes Sold") +  theme(axis.title = element_text(),
        legend.text = element_text(size = 10))
```

## So what can we see?
Let's zoom into our best sellers
```{r, echo=FALSE}
ggplot(data = Texas_Housing %>% filter(ID.Value.Bucket == "15"|ID.Value.Bucket == "16"|ID.Value.Bucket == "17"|ID.Value.Bucket == "18"|ID.Value.Bucket == "19"|ID.Value.Bucket == "20"|ID.Value.Bucket == "21"|ID.Value.Bucket == "22"),aes( x = reorder(Value.Bucket, -ID.Value.Bucket), y = Property.Value.by.Bucket, fill = Geography)) +
  geom_bar( stat = "identity" ,position = "dodge") + coord_flip() + labs( title = "Housing Market in Major Texan Cities", subtitle = "2019", x = "Value of Homes", y = "Number of Homes Sold") +  theme(axis.title = element_text(),
        legend.text = element_text(size = 10))

```

### In Houston most homes sold are sold at almost an even rate from $150,000 to $750,000
### In Dallas most homes sold are between $300,000 to $750,000
### In San Antonio most homes sold are between $200,000 to $250,000

Lots more options for 'affordable housing' in the San Antonio and Houston area! Directly correlating to the massive construction industry.

```{r, echo=FALSE}
## Commute
Texas_Commmute <- Commute %>% filter(Place == "Houston, TX" | Place == "Dallas, TX" |Place == "San Antonio, TX") 
  
  
  ggplot( Texas_Commmute , aes(x = `Average Commute Time`, y = Place)) + geom_density_ridges(aes(fill = Place), alpha = .7) + 
    labs( title = " Commute Time", subtitle = "Within Houston, Dallas and San Antonio", x = "Average Commute Time", y = "Location") + 
  theme_fivethirtyeight() +
  theme(axis.title = element_text(),
        legend.text = element_text(size = 10))
        
```


#Demographics! 
Who will be your neighbor? What will the culture of the city feel like?\

```{r}
treemap(HTX_People %>% filter(Year == "2019") %>% group_by(ID.Race), 
        index=c("Ethnicity","Race","share"), 
        vSize = "share",  #This is your quantitative variable
        type = "index", 
        
        title="Demographic of Houstonians", #Customize your title
        fontsize.title = 20,
        fontsize.labels = 14
        )




```









# References
```
https://www.moving.com/tips/how-to-choose-the-right-city-for-you/ 
```













